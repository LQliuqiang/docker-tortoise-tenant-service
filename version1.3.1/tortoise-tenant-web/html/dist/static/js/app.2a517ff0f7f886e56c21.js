webpackJsonp([1],{"+v2P":function(e,t){},"/DBc":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB3ElEQVRIS+XUP4gTQRQG8G+GQDYglv7l4MLON4XFIYh/0BOstDrsrBRUBOsTK0HuxFZUEASbw1LtRI9TK0stRIQoJG/dxEbPRuxiYHefLKQI8ZLdeBcs3HZn5vfet/PWYMqPmfL5+A+ARqOxLQiCOWPMwSzLvgL4SPJT2WjHRtRsNpettZcA/FDV18aYWQAHAHwzxlx3zq0VQSMBEXmqqrPW2ovOuXeDB4nIIoArAJZIroxDNgREJK/6Bsm9oza3Wq3Dxpg3lUrlSL1efztq3R9AHMc70zRdt9YuhGH4fFx1URRdzbLstPf+eGlARE4CWCZ5tChfEdkH4BnJsDSQV6Wqe0jmGY992u12kCTJT5JBaUBEzgFYIHmmCOh0OruTJHnvnNtVGojjeC5N01WSM0VAFEXHANxxzh0qDeQL+1d03Xt/eRwiIi8BrJG8OxEQRdEOVf0O4BTJV8ObRWQ7gEVjzHnnXH3iOeh3kd+QJwA+qOpqrVZ70e12aa2dV9ULAD4DCI0xD51ztybqYGhqlwDsB3ACwC8AXwA86vV696vVqsuLUNV73vsHGyGb/l33ZyHvdIXk7WFk08BgnKr62Ht/cxDZEmAAuUby7FSAv/7IRcNW9H7LIvpnHfwG++qwGSxkhuEAAAAASUVORK5CYII="},"1LUP":function(e,t){},"1pOx":function(e,t){},"2Xx4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAByElEQVQ4T5WUQY7aMBSG32+FhbOCDZLtDTconGDgBDNzgpmeYOAEpScoPUHhBM0NCieYOUI3MRKb0A0sQHnVSx3kCVAxlqwott+X//3vOaArY7PZ9I/H4xMRPYQjWZIki263+3YpBPHier0eMvN9CO4QUQZgKWeYeRjWi7CeGWNWdXwFEkBZlj8ByHsm01orz7PhvReF1WRmVko9GmOWFSjP86lsOOf611K9tJ7nuaSZOeemJxCAobVW5J9G8OkLEbWJ6HtTpfd+yczL/4IEcjgcfimlJsy8JaIZEY1j2E0gSTdW6b0fS/qx6ptAIfBFaz3odDpb7/1ccrbWPte53wSSw977jJnvAGyZ+U+apkOBfhgUYDPpoUsVvVlR1BovAN6SJJnEnX0GEj+Y+ck5N2j2SzD9mZnnrVYri0HSRwDm1tpZ1UdFUbT3+30BYCRdGsOa1av3wnXKtNY98e1010J336dpOmoYKmXvx9UKH35l5oU0o8DfXdpQYqnS56ayhpIfRLSK4e9AtbkA5FrMtNZfa3WiYrfbfQPwSERT8SW24AwU/gY9MZeZPymlqoCyLMcAVgDGxpjfzaJcBDXS+OcBML2Wruz/Bei7NyK/fbQ9AAAAAElFTkSuQmCC"},"3OUD":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAABxUlEQVQ4T61UwW0CMRDcPQmJu0/CB8nmkZSQdEA6SAe5VABUkKMCLhVAKgipIJRACeGBLfGBFzxA3mguNjIJoETKPe6ks3d2ZnZspn96+ByOtTYXkQfsYeaRUurl1P6jQNbaaxEZftVzgWIRwVeY+VEp9fEd8AfQfD4vmDkHgFJqFBcYY7pE1GXmoVKqH6/tgRaLxc12ux0y8yxN07zRaKyOyfBsSxG5qtVqj81mc1pJxytikSulJr/x3xhzT0RgXGityxgIlDvnDI0boDkRdYjoudVqFQfSdrsdKF8kSdI7xcxa2/aDmMHLYHwFhMV6vT6FL37khYi8Z1nWC155bwZEdAvDtdZj1MJb+FQBGWNKIrr3HSbL5fJyvV5DKqY0FJFLrIlIP8uy0jcMzN601t29NE95FDPxLGAqAjWGDN9kwMx3ofF+aoFeNEEwyQP9YDJkO+cgrzL4mDSM8Sqk1jPBPyS5cM5BGsCR9MrgKP0zrXUeS4MHJTMPQmq98TkRrby0Kuk+dwesD44I9G82GxjfjvVH0vYGp2laxOk/dWhRgO6vzPwMIOfcE0afJEn3WMbOXiNeQtszGuMo/Oka+c1Z+77nEwhdGSLoIjD0AAAAAElFTkSuQmCC"},"7z0o":function(e,t){},JBOx:function(e,t){},Kr3D:function(e,t){},L7qy:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAB+0lEQVQ4T62UQW7aQBSG3xu8YLwKG6QZb9ITFE5QOEHpCUJOUOgJuEG5QekBqnCDuDfgBiELP0tsyM6WsPyq3xpHECDZdCRLlj3zvf/977eZ/tPijzj7/f4Ge3q93st7e98FiciKiO4CYG2tvb8GPAOJyJKIblV1Q0STOI5HABVFsSai5hkRPXjv58cKT0B5nk9VdcHMo7qu18y88N4DQCIyUdVfxphheLfy3qNos05AIpIS0RobRESjKBr2+32ooDzPofLJe8+h4NR736g9A2VZtjHGzLrd7qYoir21tnfsCeDMPMbBuq5/JkkyvKao2eicS0Vki9acczCcdrvdoKqq1Fp7W5blQFUfoe4aCH5svfczEZmp6l0cx2Ooglpm3njvp2EgN7i/CMrzfIRKbUutZ4AT0dJaOwgT3B/7d+bRBdBKVbfGmLT1BAGFf8w8dc79PlEU+n9AgJkZZq/LsvweojAO5kPVIzPPVRXKMHpM9hsm25glIo03URT9qarqRwjd32A2ItGOfxGSnkZRND8cDhNkDjFoQSkOqSomhCAunXNQcLZCawB+ZeZ7qH4FZVm2MMbAjydUIKLnayAEk4i+oCgzfyKiESLyNtmADZj585GUpjV8f+HC/TNASZJA2Xmyj/sIlXH4dXU6nZf2k3nb84f/o0s+XXr2DwnUIiIU0YfBAAAAAElFTkSuQmCC"},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("//Fk"),o=s.n(a),n=s("7+uW"),i={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"loading"}},[t("div"),this._v(" "),t("div",[t("div",{staticClass:"loader loader-3"},[t("div",{staticClass:"dot dot1"}),this._v(" "),t("div",{staticClass:"dot dot2"}),this._v(" "),t("div",{staticClass:"dot dot3"})])])])}]};var l=s("VU/8")({name:"Progress"},i,!1,function(e){s("Qusd")},"data-v-4afd633a",null).exports,r={name:"Toast",props:{type:String,msg:String}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"fade"}},[s("div",{class:{toast_icon_info_bg:"info"===e.type,toast_icon_warning_bg:"warning"===e.type,toast_icon_success_bg:"success"===e.type,toast_icon_error_bg:"error"===e.type},attrs:{id:"toast"}},[s("span",{class:{toast_icon_info:"info"===e.type,toast_icon_warning:"warning"===e.type,toast_icon_success:"success"===e.type,toast_icon_error:"error"===e.type}}),e._v(" "),s("p",{staticClass:"font_3_nowrap"},[e._v(e._s(e.msg))])])])},staticRenderFns:[]};var d=s("VU/8")(r,c,!1,function(e){s("JBOx")},"data-v-83c9ec3a",null).exports,p={name:"App",components:{Progress:l,Toast:d},data:function(){return{progressShow:!1,toastShow:!1,toast:{type:"info",msg:""}}},created:function(){var e=this.$global.getAuthInfo();null==e?this.$router.replace("/login"):this.$axios.defaults.headers.common.token=e.tokenValue},mounted:function(){var e=this;this.$pubSub.subscribe("progressShow",function(t,s){e.progressShow=s}),this.$pubSub.subscribe("toastShow",function(t,s){e.toastShow=!0,e.toast=s;var a=setTimeout(function(){e.toastShow=!1,clearTimeout(a)},3e3)})}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view"),this._v(" "),t("Progress",{directives:[{name:"show",rawName:"v-show",value:this.progressShow,expression:"progressShow"}]}),this._v(" "),t("Toast",{directives:[{name:"show",rawName:"v-show",value:this.toastShow,expression:"toastShow"}],attrs:{type:this.toast.type,msg:this.toast.msg}})],1)},staticRenderFns:[]};var u=s("VU/8")(p,m,!1,function(e){s("i+1B")},null,null).exports,h=s("/ocq"),v=s("mvHQ"),f=s.n(v),g={name:"TortoiseLogin",components:{Toast:d},created:function(){this.$global.destroy()},mounted:function(){this.$global.destroy()},data:function(){return{userInfo:{username:"",password:""},validatePass:{username:!1,password:!1},toastShow:!1,toast:{type:"warning",msg:""}}},methods:{resetClick:function(){this.userInfo={username:"",password:""}},loginClick:function(){var e=this;this.$axios.post(this.$global.url.tenant.auth,this.userInfo).then(function(t){null!==t&&(e.$axios.defaults.headers.common.token=t.data.data.tokenValue,sessionStorage.setItem(e.$global.cacheKey.authInfoKey,f()(t.data.data)),e.$router.push("/"))})}},watch:{"userInfo.username":{deep:!0,handler:function(e,t){this.validatePass.username=e.length>5&&e.length<15}},"userInfo.password":{deep:!0,handler:function(e,t){this.validatePass.password=e.length>7&&e.length<19}}}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login_bg"},[s("div",{staticClass:"col-sm-4 vertical_center"},[s("h1",{staticClass:"text-center",staticStyle:{color:"white","margin-bottom":"15px"}},[e._v("Tortoise tenant system")]),e._v(" "),s("div",{staticClass:"panel panel-default out_shadow"},[s("div",{staticClass:"panel-body"},[s("div",{staticClass:"form-group"},[s("label",[e._v("用户名")]),s("span",{staticClass:"small text-info pull-right"},[e._v("(长度6~16)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.username,expression:"userInfo.username"}],staticClass:"form-control",attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.userInfo.username},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"username",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",[e._v("密码")]),s("span",{staticClass:"small text-info pull-right"},[e._v("(长度8~20)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.password,expression:"userInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"请输入密码",disabled:!e.validatePass.username},domProps:{value:e.userInfo.password},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"password",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:e.resetClick}},[e._v("重置")]),e._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.loginClick}},[e._v("登录\n          ")])])])])]),e._v(" "),s("Toast",{directives:[{name:"show",rawName:"v-show",value:e.toastShow,expression:"toastShow"}],attrs:{type:e.toast.type,msg:e.toast.msg}})],1)},staticRenderFns:[]};var _=s("VU/8")(g,I,!1,function(e){s("+v2P")},"data-v-d1c9e76a",null).exports,C={name:"TortoiseIndex",data:function(){return{menuLiActive:"tenant",username:"用户名",headUrl:""}},created:function(){this.menuLiActive="tenant",this.$router.replace("/index/tenant");var e=this.$global.getAuthInfo().object;this.username=e.tenantName,this.headUrl=e.headUrl},mounted:function(){},methods:{leftMenuClick:function(e){"li"===e.target.localName&&(this.menuLiActive=void 0===e.target.type?"tenant":e.target.type,this.$router.replace("/index/"+this.menuLiActive))},exitLogin:function(){this.$router.replace("/login")}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("nav",{staticClass:"navbar navbar-inverse navbar-fixed-top"},[e._m(0),e._v(" "),a("div",{staticClass:"collapse navbar-collapse"},[a("ul",{staticClass:"nav navbar-nav navbar-right",staticStyle:{"margin-right":"10px"}},[e._m(1),e._v(" "),a("li",[a("a",{attrs:{href:"javascript:"}},[e._v(e._s(e.username))])]),e._v(" "),a("li",{on:{click:e.exitLogin}},[a("a",{attrs:{href:"javascript:"}},[e._v("退出登录")])])])])]),e._v(" "),a("div",{staticClass:"row"},[a("ul",{staticClass:"col-sm-2 menu text-center list-unstyled",on:{click:e.leftMenuClick}},[a("img",{staticClass:"text-center img-circle",staticStyle:{"margin-top":"20px","margin-bottom":"10px","min-width":"80px","max-width":"300px","min-height":"80px","max-height":"300px"},attrs:{src:e.$global.url.base+e.headUrl}}),e._v(" "),a("li",{class:{menuLiHover:"tenant"===e.menuLiActive,menuLiLever:"tenant"!==e.menuLiActive},attrs:{type:"tenant"}},[a("img",{attrs:{src:s("Oujo"),alt:"租户管理"}}),e._v("\n        租户管理\n      ")]),e._v(" "),a("li",{class:{menuLiHover:"user"===e.menuLiActive,menuLiLever:"user"!==e.menuLiActive},attrs:{type:"user"}},[a("img",{attrs:{src:s("L7qy"),alt:"用户管理"}}),e._v("\n        用户管理\n      ")]),e._v(" "),a("li",{class:{menuLiHover:"department"===e.menuLiActive,menuLiLever:"department"!==e.menuLiActive},attrs:{type:"department"}},[a("img",{attrs:{src:s("3OUD"),alt:"部门管理"}}),e._v("\n        部门管理\n      ")]),e._v(" "),a("li",{class:{menuLiHover:"role"===e.menuLiActive,menuLiLever:"role"!==e.menuLiActive},attrs:{type:"role"}},[a("img",{attrs:{src:s("w4Qz"),alt:"角色管理"}}),e._v("\n        角色管理\n      ")]),e._v(" "),a("li",{class:{menuLiHover:"permission"===e.menuLiActive,menuLiLever:"permission"!==e.menuLiActive},attrs:{type:"permission"}},[a("img",{attrs:{src:s("2Xx4"),alt:"权限管理"}}),e._v("\n        权限管理\n      ")]),e._v(" "),a("li",{class:{menuLiHover:"personal"===e.menuLiActive,menuLiLever:"personal"!==e.menuLiActive},attrs:{type:"personal"}},[a("img",{attrs:{src:s("xggO"),alt:"个人中心"}}),e._v("\n        个人中心\n      ")])]),e._v(" "),a("div",{staticClass:"col-sm-offset-2 col-sm-10 topNav"},[a("router-view")],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"navbar-header"},[t("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[this._v("Tortoise Tenant Manage System")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"search"},[t("input",{staticClass:"inputNo",staticStyle:{"vertical-align":"middle"},attrs:{type:"text",placeholder:"搜索内容"}}),this._v(" "),t("img",{attrs:{src:s("/DBc")}})])}]};var b=s("VU/8")(C,w,!1,function(e){s("lZx4")},null,null).exports,y={name:"ModelDialog",props:{title:String,closeClick:Function,sureClick:Function},data:function(){return{modalTitle:this.title}},methods:{modelDialogClose:function(){this.closeClick()},modalCloseClick:function(){this.closeClick()},modalSureClick:function(){this.sureClick()}}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"fade"}},[s("div",{staticClass:"modal_custom"},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:e.modelDialogClose}},[s("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])]),e._v(" "),s("h4",{staticClass:"modal-title"},[e._v(e._s(e.modalTitle))])]),e._v(" "),e._t("modalBody"),e._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:e.modalCloseClick}},[e._v("关闭")]),e._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.modalSureClick}},[e._v("确定")])])],2)])])])},staticRenderFns:[]};var D=s("VU/8")(y,x,!1,function(e){s("1LUP")},"data-v-069f113c",null).exports,A={name:"TortoiseTenant",components:{ModalDialog:D},data:function(){return{tenantInfos:[],isAdmin:!1,tenantAddModalDialogShow:!1,tenantDetailModalDialogShow:!1,tenantUpdateModalDialogShow:!1,tenantOperate:!1,tenantInfo:{tenantName:"",password:"",company:"",email:null,phone:null,headFile:null,statusValue:"开放",status:1},validatePass:{tenantName:!1,password:!1,company:!1,headFile:!1},tenantDetail:{},tenantUpdateInfo:{},adminRoleInfos:[],currentTenantRoleNames:"",checkTenantRoleIds:[2],currentTenantIndex:0}},mounted:function(){var e=this;"1"===this.$global.getAuthInfo().object.roleIds?(this.isAdmin=!0,null==this.$global.getTenantInfos()?this.$axios.get(this.$global.url.tenant.get).then(function(t){if(null!==t){var s=t.data.data.filter(function(e){return"1"!==e.roleIds});e.tenantInfos=s,sessionStorage.setItem(e.$global.cacheKey.tenantInfosKey,f()(s))}}):this.tenantInfos=this.$global.getTenantInfos()):this.tenantInfos.push(this.$global.getAuthInfo().object)},beforeDestroy:function(){!0===this.tenantOperate&&(sessionStorage.setItem(this.$global.cacheKey.tenantInfosKey,f()(this.tenantInfos)),this.tenantOperate=!1)},methods:{selectLogo:function(e){this.tenantInfo.headFile=e.target.files[0],this.validatePass.headFile=/\.(png|jpg|gif)$/i.test(this.tenantInfo.headFile.name)&&this.tenantInfo.headFile.size<2097152},selectUpdateLogo:function(e){this.tenantUpdateInfo.headFile=e.target.files[0],this.validatePass.headFile=/\.(png|jpg|gif)$/i.test(this.tenantUpdateInfo.headFile.name)&&this.tenantUpdateInfo.headFile.size<2097152},getAdminRoleInfos:function(){var e=this;0===this.adminRoleInfos.length&&(null==this.$global.getRoleInfos()?this.$axios.get(this.$global.url.role.get).then(function(t){null!==t&&(e.adminRoleInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(t.data.data)))}):this.adminRoleInfos=this.$global.getRoleInfos())},addTenantModalCloseClick:function(){this.tenantAddModalDialogShow=!1},addTenantModalSureClick:function(){var e=this;if(this.tenantInfo.status="开放"===this.tenantInfo.statusValue?1:0,this.validatePass.tenantName&&this.validatePass.password&&this.validatePass.company){this.tenantAddModalDialogShow=!1;var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),a="";this.checkTenantRoleIds.forEach(function(e){return a+=e+","}),this.tenantInfo.roleIds=a;var o=new FormData;o.append("tenantName",this.tenantInfo.tenantName),o.append("password",this.tenantInfo.password),o.append("company",this.tenantInfo.company),null!=this.tenantInfo.email&&this.tenantInfo.email.length>0&&o.append("email",this.tenantInfo.email),null!=this.tenantInfo.phone&&this.tenantInfo.phone.length>0&&o.append("phone",this.tenantInfo.phone),null!=this.tenantInfo.roleIds&&this.tenantInfo.roleIds.length>0&&o.append("roleIds",this.tenantInfo.roleIds),this.validatePass.headFile&&o.append("headFile",this.tenantInfo.headFile),o.append("status",this.tenantInfo.status),this.$axios.post(this.$global.url.tenant.add,o).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s,e.tenantInfos.push(a),e.tenantOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"租户信息添加成功"})}})}else this.$pubSub.publish("toastShow",{type:"warning",msg:"请按要求填写必要信息,谢谢!!"})},addTenantClick:function(){this.tenantInfo={tenantName:"",password:"",company:"",email:null,phone:null,statusValue:"开放",status:1},this.checkTenantRoleIds=[2],this.getAdminRoleInfos(),this.tenantAddModalDialogShow=!0},tenantDetailModalCloseClick:function(){this.tenantDetailModalDialogShow=!1},tenantDetailModalSureClick:function(){this.tenantDetailModalDialogShow=!1},tenantUpdateModalCloseClick:function(){this.tenantUpdateModalDialogShow=!1},tenantUpdateModalSureClick:function(){var e=this,t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),a="";this.checkTenantRoleIds.forEach(function(e){return a+=e+","}),this.tenantUpdateInfo.status="开放"===this.tenantUpdateInfo.statusValue?1:0,this.tenantUpdateInfo.roleIds=a,this.tenantUpdateModalDialogShow=!1;var o=new FormData;o.append("tenantId",this.tenantUpdateInfo.tenantId),o.append("tenantName",this.tenantUpdateInfo.tenantName),null!=this.tenantUpdateInfo.password&&this.tenantUpdateInfo.password.length>7&&o.append("password",this.tenantUpdateInfo.password),o.append("company",this.tenantUpdateInfo.company),null!=this.tenantUpdateInfo.email&&this.tenantUpdateInfo.email.length>0&&o.append("email",this.tenantUpdateInfo.email),null!=this.tenantUpdateInfo.phone&&this.tenantUpdateInfo.phone.length>0&&o.append("phone",this.tenantUpdateInfo.phone),null!=this.tenantUpdateInfo.roleIds&&this.tenantUpdateInfo.roleIds.length>0&&o.append("roleIds",this.tenantUpdateInfo.roleIds),this.validatePass.headFile&&o.append("headFile",this.tenantUpdateInfo.headFile),this.$axios.put(this.$global.url.tenant.update,o).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,e.tenantInfos.splice(e.currentTenantIndex,1,a),e.tenantOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"修改租户信息成功"})}})},delegateAppItemClick:function(e,t,s){var a=this;switch(this.currentTenantIndex=s,e.target.innerText){case"禁用":case"开放":var o={};o.status=1===t.status?0:1,o.tenantId=t.tenantId,this.$axios.put(this.$global.url.tenant.updateTenantStatus,o).then(function(e){null!==e&&(1===t.status?(t.status=0,t.statusValue="禁用"):(t.status=1,t.statusValue="开放")),a.tenantOperate=!0,a.$pubSub.publish("toastShow",{type:"success",msg:"租户状态修改成功"})});break;case"详情":if(t.roleInfos){var n="",i="";t.roleInfos.forEach(function(e){n+=e.roleName+" ",null!==e.permissionInfos&&e.permissionInfos.forEach(function(e){i+=e.permissionName+" "})}),t.roleNames=n,t.permissionNames=i}this.tenantDetail=t,this.tenantDetailModalDialogShow=!0;break;case"修改":this.checkTenantRoleIds=[],t.roleInfos&&t.roleInfos.forEach(function(e){return a.checkTenantRoleIds.push(e.id)}),this.tenantUpdateInfo=t,this.getAdminRoleInfos(),this.tenantUpdateModalDialogShow=!0}}},watch:{"tenantInfo.tenantName":{deep:!0,handler:function(e,t){this.validatePass.tenantName=e.length>5&&e.length<15}},"tenantInfo.password":{deep:!0,handler:function(e,t){this.validatePass.password=e.length>7&&e.length<19}},"tenantInfo.company":{deep:!0,handler:function(e,t){this.validatePass.company=e.length>0&&e.length<32}}}},k={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topNav"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:e.addTenantClick}},[e._v("新增租户")]),e._v(" "),s("table",{staticClass:"table table-striped table-bordered table-hover text-center top15"},[e._m(0),e._v(" "),s("tbody",e._l(e.tenantInfos,function(t,a){return s("tr",{key:a,on:{click:function(s){return e.delegateAppItemClick(s,t,a)}}},[s("td",[e._v(e._s(t.company))]),e._v(" "),s("td",[e._v(e._s(t.tenantName))]),e._v(" "),s("td",[e._v(e._s(1===t.status?"开放":"禁用"))]),e._v(" "),s("td",[e._v(e._s(t.updateDate))]),e._v(" "),s("td",{staticClass:"text-center"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-xs btn-danger",attrs:{type:"button"}},[e._v(e._s(1===t.status?"开放":"禁用"))]),e._v(" "),s("button",{staticClass:"btn btn-xs btn-info",attrs:{type:"button"}},[e._v("详情")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-xs btn-primary",attrs:{type:"button"}},[e._v("修改")])])])}),0)]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.tenantAddModalDialogShow,expression:"tenantAddModalDialogShow"}],attrs:{title:"租户添加","close-click":e.addTenantModalCloseClick,"sure-click":e.addTenantModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("账号")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.tenantName,expression:"tenantInfo.tenantName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant name (长度6~16)"},domProps:{value:e.tenantInfo.tenantName},on:{input:function(t){t.target.composing||e.$set(e.tenantInfo,"tenantName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.password,expression:"tenantInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"tenant password (长度8~24)",disabled:!e.validatePass.tenantName},domProps:{value:e.tenantInfo.password},on:{input:function(t){t.target.composing||e.$set(e.tenantInfo,"password",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("公司")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.company,expression:"tenantInfo.company"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant company (长度2~32)",disabled:!e.validatePass.password},domProps:{value:e.tenantInfo.company},on:{input:function(t){t.target.composing||e.$set(e.tenantInfo,"company",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("邮箱")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.email,expression:"tenantInfo.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"tenant email"},domProps:{value:e.tenantInfo.email},on:{input:function(t){t.target.composing||e.$set(e.tenantInfo,"email",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("电话")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.phone,expression:"tenantInfo.phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant phone"},domProps:{value:e.tenantInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.tenantInfo,"phone",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{staticClass:"file-upload",attrs:{type:"file"},on:{change:e.selectLogo}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("状态")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.tenantInfo.statusValue,expression:"tenantInfo.statusValue"}],staticClass:"form-control",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.tenantInfo,"statusValue",t.target.multiple?s:s[0])}}},[s("option",[e._v("禁用")]),e._v(" "),s("option",[e._v("开放")])])])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色")]),e._v(" "),s("div",{staticClass:"col-sm-9"},e._l(e.adminRoleInfos,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkTenantRoleIds,expression:"checkTenantRoleIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkTenantRoleIds)?e._i(e.checkTenantRoleIds,t.id)>-1:e.checkTenantRoleIds},on:{change:function(s){var a=e.checkTenantRoleIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkTenantRoleIds=a.concat([i])):l>-1&&(e.checkTenantRoleIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkTenantRoleIds=n}}}),e._v(" "+e._s(t.roleName)+"\n            ")])}),0)])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.tenantDetailModalDialogShow,expression:"tenantDetailModalDialogShow"}],attrs:{title:"租户详情","close-click":e.tenantDetailModalCloseClick,"sure-click":e.tenantDetailModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"row"},[s("img",{staticClass:"text-center img-circle col-sm-3",staticStyle:{"margin-top":"10px","min-height":"80px","max-height":"300px"},attrs:{src:e.$global.url.base+e.tenantDetail.headUrl}}),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("h3",{staticClass:"h3"},[e._v(e._s(e.tenantDetail.tenantName))]),e._v(" "),s("p",[e._v("状态: "),s("span",{staticClass:"text-info"},[e._v(e._s(1===e.tenantDetail.status?"开放":"禁用"))])]),e._v(" "),s("p",[e._v("公司: "+e._s(e.tenantDetail.company))]),e._v(" "),s("p",[e._v("号码: "+e._s(e.tenantDetail.phone))]),e._v(" "),s("p",[e._v("邮箱: "+e._s(e.tenantDetail.email))]),e._v(" "),s("p",[e._v("角色: "+e._s(e.tenantDetail.roleNames))]),e._v(" "),s("p",[e._v("权限: "+e._s(e.tenantDetail.permissionNames))]),e._v(" "),s("p",[e._v("创建时间: "+e._s(e.tenantDetail.createDate))]),e._v(" "),s("p",[e._v("更新时间: "+e._s(e.tenantDetail.updateDate))])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.tenantUpdateModalDialogShow,expression:"tenantUpdateModalDialogShow"}],attrs:{title:"租户修改","close-click":e.tenantUpdateModalCloseClick,"sure-click":e.tenantUpdateModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("账号")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantUpdateInfo.tenantName,expression:"tenantUpdateInfo.tenantName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant name (长度6~16)"},domProps:{value:e.tenantUpdateInfo.tenantName},on:{input:function(t){t.target.composing||e.$set(e.tenantUpdateInfo,"tenantName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantUpdateInfo.password,expression:"tenantUpdateInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"tenant password (长度8~24)"},domProps:{value:e.tenantUpdateInfo.password},on:{input:function(t){t.target.composing||e.$set(e.tenantUpdateInfo,"password",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("公司")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantUpdateInfo.company,expression:"tenantUpdateInfo.company"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant company (长度2~32)"},domProps:{value:e.tenantUpdateInfo.company},on:{input:function(t){t.target.composing||e.$set(e.tenantUpdateInfo,"company",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("邮箱")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantUpdateInfo.email,expression:"tenantUpdateInfo.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"tenant email"},domProps:{value:e.tenantUpdateInfo.email},on:{input:function(t){t.target.composing||e.$set(e.tenantUpdateInfo,"email",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("电话")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tenantUpdateInfo.phone,expression:"tenantUpdateInfo.phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant phone"},domProps:{value:e.tenantUpdateInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.tenantUpdateInfo,"phone",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{staticClass:"file-upload",attrs:{type:"file"},on:{change:e.selectUpdateLogo}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色")]),e._v(" "),s("div",{staticClass:"col-sm-9"},e._l(e.adminRoleInfos,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkTenantRoleIds,expression:"checkTenantRoleIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkTenantRoleIds)?e._i(e.checkTenantRoleIds,t.id)>-1:e.checkTenantRoleIds},on:{change:function(s){var a=e.checkTenantRoleIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkTenantRoleIds=a.concat([i])):l>-1&&(e.checkTenantRoleIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkTenantRoleIds=n}}}),e._v(" "+e._s(t.roleName)+"\n            ")])}),0)])])])])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"text-center"},[e._v("公司")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("账号")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("状态")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("更新时间")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("操作")])])])}]};var U=s("VU/8")(A,k,!1,function(e){s("Kr3D")},"data-v-0a6f1d45",null).exports,S=s("ifoU"),P=s.n(S),N={name:"TortoiseUser",components:{ModalDialog:D},data:function(){return{userInfos:[],isAdmin:!1,tenantId:"",showPageArr:[],totalPage:0,totalSize:0,currentPage:1,pageSize:10,isFirstPage:!0,userAddModalDialogShow:!1,userDetailModalDialogShow:!1,userUpdateModalDialogShow:!1,userInfo:{username:"",password:"",firstName:"",lastName:"",company:"",department:"",duty:"",email:null,phone:null,headFile:null,statusValue:"开放",status:1},validatePass:{username:!1,password:!1,firstName:!1,company:!1,department:!1,headFile:!1},departments:[],selectDepartment:"ALL",userDetail:{},transformPermissions:[],transformPermissionMap:new P.a,tenantRoleInfos:[],checkUserRoleIds:[],userUpdateInfo:{},currentUserIndex:0,selectSearchFilterField:"用户名",showSelectFilterFieldMenu:!1,inputSearchData:""}},created:function(){this.isAdmin="1"===this.$global.getAuthInfo().object.roleIds,this.tenantId=this.$global.getAuthInfo().object.tenantId,this.departments=null!=this.$global.getAuthInfo().object.departmentInfos?this.$global.getAuthInfo().object.departmentInfos:[]},mounted:function(){this.getUserInfos(this.tenantId,1,this.pageSize)},methods:{selectLogo:function(e){this.userInfo.headFile=e.target.files[0],this.validatePass.headFile=/\.(png|jpg|gif)$/i.test(this.userInfo.headFile.name)&&this.userInfo.headFile.size<2097152},selectUpdateLogo:function(e){this.userUpdateInfo.headFile=e.target.files[0],this.validatePass.headFile=/\.(png|jpg|gif)$/i.test(this.userUpdateInfo.headFile.name)&&this.userUpdateInfo.headFile.size<2097152},chooseDepartmentClick:function(e){e="ALL"===e?null:this.getDepartmentIdByDepartmentName(e),this.getUserInfos(this.tenantId,this.currentPage,this.pageSize,null,null,null,null,null,e)},getDepartmentIdByDepartmentName:function(e){for(var t=null,s=0;s<this.departments.length;s++){var a=this.departments[s];if(a.departmentName===e){t=a.id;break}}return t},transformPermissionInfos:function(e){var t=this;this.transformPermissionMap.clear(),e.forEach(function(e){var s=t.transformPermissionMap.get(e.permissionType);null!=s?s.push(e):(s=[]).push(e),t.transformPermissionMap.set(e.permissionType,s)}),this.transformPermissionMap.forEach(function(e,s){var a={};a.permissionType=s,a.permissions=e,t.transformPermissions.push(a)})},searchFilterClick:function(){this.showSelectFilterFieldMenu=!this.showSelectFilterFieldMenu},selectFilterFieldClick:function(e){this.selectSearchFilterField=e.target.innerText,this.showSelectFilterFieldMenu=!this.showSelectFilterFieldMenu},searchBtnClick:function(){switch(this.currentPage=1,this.selectSearchFilterField){case"用户名":this.getUserInfos(this.tenantId,this.currentPage,this.pageSize,this.inputSearchData,null);break;case"中文名":this.getUserInfos(this.tenantId,this.currentPage,this.pageSize,null,this.inputSearchData,null);break;case"英文名":this.getUserInfos(this.tenantId,this.currentPage,this.pageSize,null,null,this.inputSearchData,null);break;default:this.getUserInfos(this.tenantId,this.currentPage,this.pageSize)}},getUserInfos:function(e,t,s,a,o,n,i,l,r){var c=this;this.$axios.get(this.$global.url.user.get,{params:{tenantId:e,page:t,pageSize:s,username:a,firstName:o,lastName:n,company:i,duty:l,departmentId:r}}).then(function(e){null!==e&&(c.userInfos=e.data.data,c.totalPage=e.data.totalPage,c.totalSize=e.data.totalSize,c.getShowPageArr())})},firstPageClick:function(){1!==this.currentPage&&(this.currentPage=1,this.showPageArr=[],this.getUserInfos(this.tenantId,this.currentPage,this.pageSize),this.getShowPageArr())},lastPageClick:function(){if(this.currentPage!==this.totalPage){var e=parseInt(this.totalSize/this.pageSize)+1;if(this.currentPage=e,e>5){this.showPageArr=[];for(var t=e-4;t<=e;t++)this.showPageArr.push(t)}else this.getShowPageArr();this.getUserInfos(this.tenantId,this.currentPage,this.pageSize)}},prePageClick:function(){if(1!==this.currentPage){var e=this.showPageArr[0];e>1&&this.currentPage===e&&(this.showPageArr=this.showPageArr.map(function(e){return e-1})),this.currentPage>1&&(this.currentPage--,this.getUserInfos(this.tenantId,this.currentPage,this.pageSize))}},nextPageClick:function(){if(this.currentPage!==this.totalPage){var e=this.totalSize/this.pageSize,t=this.showPageArr[this.showPageArr.length-1];t<e&&this.currentPage===t&&(this.showPageArr=this.showPageArr.map(function(e){return e+1})),this.currentPage<e&&(this.currentPage++,this.getUserInfos(this.tenantId,this.currentPage,this.pageSize))}},pageClick:function(e){this.currentPage=e,this.getUserInfos(this.tenantId,e,this.pageSize)},getShowPageArr:function(){this.showPageArr=[];var e=this.totalSize/this.pageSize+1;if(e>5)for(var t=1;t<=5;t++)this.showPageArr.push(t);else for(var s=1;s<e;s++)this.showPageArr.push(s)},addUserClick:function(){var e=this;this.userInfo={username:"",password:"",firstName:"",lastName:"",company:"",department:"",duty:"",email:null,phone:null,headFile:null,statusValue:"开放",status:1},this.userInfo.company=this.$global.getAuthInfo().object.company,this.checkUserRoleIds=[],0===this.tenantRoleInfos.length&&(null==this.$global.getRoleInfos()?this.$axios.get(this.$global.url.role.get).then(function(t){null!==t&&(e.tenantRoleInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(t.data.data)))}):this.tenantRoleInfos=this.$global.getRoleInfos()),this.departments.length>0&&(this.userInfo.department=this.departments[0].departmentName),this.userAddModalDialogShow=!0},addUserModalCloseClick:function(){this.userAddModalDialogShow=!1},addUserModalSureClick:function(){var e=this;if(this.userInfo.status="开放"===this.userInfo.statusValue?1:0,this.validatePass.username&&this.validatePass.password&&this.validatePass.firstName&&this.validatePass.company&&this.validatePass.department){var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();if(this.userAddModalDialogShow=!1,this.checkUserRoleIds.length>0){var a="";this.checkUserRoleIds.forEach(function(e){return a+=e+","}),this.userInfo.roleIds=a}else this.userInfo.roleIds=null;var o=new FormData;o.append("username",this.userInfo.username),o.append("password",this.userInfo.password),o.append("firstName",this.userInfo.firstName),o.append("lastName",this.userInfo.lastName),o.append("company",this.userInfo.company),o.append("departmentId",this.getDepartmentIdByDepartmentName(this.userInfo.department)),o.append("duty",this.userInfo.duty),null!=this.userInfo.email&&this.userInfo.email.length>0&&o.append("email",this.userInfo.email),null!=this.userInfo.phone&&this.userInfo.phone.length>0&&o.append("phone",this.userInfo.phone),null!=this.userInfo.roleIds&&this.userInfo.roleIds.length>0&&o.append("roleIds",this.userInfo.roleIds),this.validatePass.headFile&&o.append("headFile",this.userInfo.headFile),o.append("status",this.userInfo.status),this.$axios.post(this.$global.url.user.add,o).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s,e.userInfos.push(a),e.$pubSub.publish("toastShow",{type:"success",msg:"添加用户信息成功"})}})}else this.$pubSub.publish("toastShow",{type:"warning",msg:"请按要求填写必要信息,谢谢!!"})},userDetailModalCloseClick:function(){this.userDetailModalDialogShow=!1},userDetailModalSureClick:function(){this.userDetailModalDialogShow=!1},updateUserModalCloseClick:function(){this.userUpdateModalDialogShow=!1},updateUserModalSureClick:function(){var e=this,t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.userUpdateInfo.status="开放"===this.userUpdateInfo.statusValue?1:0,this.userUpdateModalDialogShow=!1;var a=new FormData;if(a.append("id",this.userUpdateInfo.id),a.append("username",this.userUpdateInfo.username),null!=this.userUpdateInfo.password&&this.userUpdateInfo.password.length>7&&a.append("password",this.userUpdateInfo.password),a.append("firstName",this.userUpdateInfo.firstName),a.append("lastName",this.userUpdateInfo.lastName),a.append("company",this.userUpdateInfo.company),a.append("departmentId",this.getDepartmentIdByDepartmentName(this.userUpdateInfo.department)),a.append("duty",this.userUpdateInfo.duty),null!=this.userUpdateInfo.email&&this.userUpdateInfo.email.length>0&&a.append("email",this.userUpdateInfo.email),null!=this.userUpdateInfo.phone&&this.userUpdateInfo.phone.length>0&&a.append("phone",this.userUpdateInfo.phone),this.checkUserRoleIds.length>0){var o="";this.checkUserRoleIds.forEach(function(e){return o+=e+","}),a.append("roleIds",o)}this.validatePass.headFile&&a.append("headFile",this.userUpdateInfo.headFile),a.append("status",this.userUpdateInfo.status),this.$axios.put(this.$global.url.user.update,a).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,e.userInfos.splice(e.currentUserIndex,1,a),e.$pubSub.publish("toastShow",{type:"success",msg:"修改用户信息成功"})}})},delegateAppItemClick:function(e,t,s){var a=this;switch(e.target.innerText){case"删除":this.$axios.delete(this.$global.url.user.delete,{params:{id:t.id}}).then(function(e){null!==e&&(a.userInfos.splice(s,1),a.$pubSub.publish("toastShow",{type:"success",msg:"用户删除成功"}))});break;case"详情":this.transformPermissions=[],t.roleInfos&&function(){for(var e="",s=[],o=0;o<t.roleInfos.length;o++){var n=t.roleInfos[o];e+=o+":"+n.roleName+" ",null!=n.permissionInfos&&n.permissionInfos.length>0&&n.permissionInfos.forEach(function(e){s.push(e)})}t.roleNames=e,a.transformPermissionInfos(s)}(),this.userDetail=t,this.userDetailModalDialogShow=!0;break;case"修改":this.checkUserRoleIds=[],t.statusValue=1===t.status?"开放":"禁用",this.userUpdateInfo=t,0===this.tenantRoleInfos.length&&(null==this.$global.getRoleInfos()?this.$axios.get(this.$global.url.role.get).then(function(e){null!==e&&(a.tenantRoleInfos=e.data.data,sessionStorage.setItem(a.$global.cacheKey.roleInfosKey,f()(e.data.data)))}):this.tenantRoleInfos=this.$global.getRoleInfos()),this.departments.length>0&&(this.userUpdateInfo.department=this.departments[0].departmentName),this.currentUserIndex=s,this.userUpdateModalDialogShow=!0}}},watch:{"userInfo.username":{deep:!0,handler:function(e,t){this.validatePass.username=e.length>5&&e.length<15}},"userInfo.password":{deep:!0,handler:function(e,t){this.validatePass.password=e.length>7&&e.length<19}},"userInfo.firstName":{deep:!0,handler:function(e,t){this.validatePass.firstName=e.length>0&&e.length<16}},"userInfo.company":{deep:!0,handler:function(e,t){this.validatePass.company=e.length>1&&e.length<32}},"userInfo.department":{deep:!0,handler:function(e,t){this.validatePass.department=e.length>0&&e.length<32}}}},M={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topNav"},[s("button",{directives:[{name:"show",rawName:"v-show",value:!e.isAdmin,expression:"!isAdmin"}],staticClass:"btn btn-sm btn-success pull-right",attrs:{type:"button"},on:{click:e.addUserClick}},[e._v("新增用户")]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-3"},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-group-btn"},[s("button",{staticClass:"btn btn-default dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},on:{click:e.searchFilterClick}},[e._v(e._s(e.selectSearchFilterField)+" "),s("span",{staticClass:"caret"})]),e._v(" "),s("ul",{staticClass:"dropdown-menu",class:{dropdown_menu_show:e.showSelectFilterFieldMenu,dropdown_menu_hide:!e.showSelectFilterFieldMenu},on:{click:e.selectFilterFieldClick}},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3)])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.inputSearchData,expression:"inputSearchData"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search for...",disabled:"部门"===e.selectSearchFilterField},domProps:{value:e.inputSearchData},on:{input:function(t){t.target.composing||(e.inputSearchData=t.target.value)}}}),e._v(" "),s("span",{staticClass:"input-group-btn"},[s("button",{staticClass:"btn btn-default",attrs:{type:"button",disabled:"部门"===e.selectSearchFilterField},on:{click:e.searchBtnClick}},[e._v("查询")])])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"部门"===e.selectSearchFilterField,expression:"selectSearchFilterField==='部门'"}],staticClass:"col-sm-2"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectDepartment,expression:"selectDepartment"}],staticClass:"form-control",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectDepartment=t.target.multiple?s:s[0]},function(t){return e.chooseDepartmentClick(e.selectDepartment)}]}},[s("option",{attrs:{value:"ALL"}},[e._v("ALL")]),e._v(" "),e._l(e.departments,function(t,a){return s("option",{key:a},[e._v(e._s(t.departmentName))])})],2)])])]),e._v(" "),s("table",{staticClass:"table table-striped table-bordered table-hover text-center top15"},[e._m(4),e._v(" "),s("tbody",e._l(e.userInfos,function(t,a){return s("tr",{key:a,on:{click:function(s){return e.delegateAppItemClick(s,t,a)}}},[s("td",[e._v(e._s(t.company))]),e._v(" "),s("td",[e._v(e._s(t.departmentInfo.departmentName))]),e._v(" "),s("td",[e._v(e._s(t.username))]),e._v(" "),s("td",[e._v(e._s(t.firstName))]),e._v(" "),s("td",[e._v(e._s(1===t.status?"可用":"不可用"))]),e._v(" "),s("td",{staticClass:"text-center"},[s("button",{directives:[{name:"show",rawName:"v-show",value:!e.isAdmin,expression:"!isAdmin"}],staticClass:"btn btn-xs btn-danger",attrs:{type:"button"}},[e._v("删除")]),e._v(" "),s("button",{staticClass:"btn btn-xs btn-info",attrs:{type:"button"}},[e._v("详情")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:!e.isAdmin,expression:"!isAdmin"}],staticClass:"btn btn-xs btn-primary",attrs:{type:"button"}},[e._v("修改")])])])}),0)]),e._v(" "),s("nav",{staticClass:"pull-right",attrs:{"aria-label":"Page navigation"}},[s("ul",{staticClass:"pagination"},[s("li",{class:{disabled:1!==e.currentPage,disabled:1===e.currentPage},on:{click:e.firstPageClick}},[s("a",{attrs:{href:"#"}},[e._v("首页")])]),e._v(" "),s("li",{class:{disabled:1!==e.currentPage,disabled:1===e.currentPage},on:{click:e.prePageClick}},[e._m(5)]),e._v(" "),e._l(e.showPageArr,function(t,a){return s("li",{class:{active:e.currentPage!==t,active:e.currentPage===t},on:{click:function(s){return e.pageClick(t)}}},[s("a",{attrs:{href:"#"}},[e._v(e._s(t))])])}),e._v(" "),s("li",{class:{disabled:e.currentPage!==e.totalPage,disabled:e.currentPage===e.totalPage},on:{click:e.nextPageClick}},[e._m(6)]),e._v(" "),s("li",{class:{disabled:e.currentPage!==e.totalPage,disabled:e.currentPage===e.totalPage},on:{click:e.lastPageClick}},[s("a",{attrs:{href:"#"}},[e._v("尾页")])])],2)]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.userAddModalDialogShow,expression:"userAddModalDialogShow"}],attrs:{title:"用户添加","close-click":e.addUserModalCloseClick,"sure-click":e.addUserModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("账号")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.username,expression:"userInfo.username"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user name (长度6~16)"},domProps:{value:e.userInfo.username},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"username",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.password,expression:"userInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"user password (长度8~24)",disabled:!e.validatePass.username},domProps:{value:e.userInfo.password},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"password",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("中文名")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.firstName,expression:"userInfo.firstName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"chinese name (长度2~16)",disabled:!e.validatePass.password,minlength:"1",maxlength:"16"},domProps:{value:e.userInfo.firstName},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"firstName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("英文名")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.lastName,expression:"userInfo.lastName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"english name (长度2~32)"},domProps:{value:e.userInfo.lastName},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"lastName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("公司")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.company,expression:"userInfo.company"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user company (长度2~32)",maxlength:"32",disabled:""},domProps:{value:e.userInfo.company},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"company",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.department,expression:"userInfo.department"}],staticClass:"form-control",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.userInfo,"department",t.target.multiple?s:s[0])}}},e._l(e.departments,function(t,a){return s("option",{key:a},[e._v(e._s(t.departmentName))])}),0)]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必选")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("职位")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.duty,expression:"userInfo.duty"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user duty (长度2~16)",maxlength:"16"},domProps:{value:e.userInfo.duty},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"duty",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("邮箱")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.email,expression:"userInfo.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"user email"},domProps:{value:e.userInfo.email},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"email",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("电话")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.phone,expression:"userInfo.phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user phone"},domProps:{value:e.userInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"phone",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{staticClass:"file-upload",attrs:{type:"file"},on:{change:e.selectLogo}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("状态")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.statusValue,expression:"userInfo.statusValue"}],staticClass:"form-control",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.userInfo,"statusValue",t.target.multiple?s:s[0])}}},[s("option",[e._v("禁用")]),e._v(" "),s("option",[e._v("开放")])])])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色")]),e._v(" "),s("div",{staticClass:"col-sm-9"},e._l(e.tenantRoleInfos,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkUserRoleIds,expression:"checkUserRoleIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkUserRoleIds)?e._i(e.checkUserRoleIds,t.id)>-1:e.checkUserRoleIds},on:{change:function(s){var a=e.checkUserRoleIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkUserRoleIds=a.concat([i])):l>-1&&(e.checkUserRoleIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkUserRoleIds=n}}}),e._v("\n                "+e._s(t.roleName)+"\n              ")])}),0)])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.userDetailModalDialogShow,expression:"userDetailModalDialogShow"}],attrs:{title:"用户详情","close-click":e.userDetailModalCloseClick,"sure-click":e.userDetailModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"row"},[s("img",{staticClass:"text-center img-circle col-sm-3",staticStyle:{"margin-top":"10px","min-height":"80px","max-height":"300px"},attrs:{src:e.$global.url.base+e.userDetail.headUrl}}),e._v(" "),s("div",{staticClass:"col-sm-8"},[s("h3",{staticClass:"h3"},[e._v(e._s(e.userDetail.username))]),e._v(" "),s("p",[e._v("状态: "),s("span",{staticClass:"text-info"},[e._v(e._s(1===e.userDetail.status?"开放":"禁用"))])]),e._v(" "),s("p",[e._v("公司: "+e._s(e.userDetail.company))]),e._v(" "),s("p",[e._v("号码: "+e._s(e.userDetail.phone))]),e._v(" "),s("p",[e._v("邮箱: "+e._s(e.userDetail.email))]),e._v(" "),s("p",[e._v("角色: "+e._s(e.userDetail.roleNames))]),e._v(" "),s("div",[e._v("权限:\n              "),s("table",{directives:[{name:"show",rawName:"v-show",value:e.transformPermissions.length>0,expression:"transformPermissions.length>0"}],staticClass:"table table-striped table-bordered table-hover"},[s("thead",[s("tr",[s("th",[e._v("类型")]),e._v(" "),s("th",[e._v("详情")])])]),e._v(" "),s("tbody",e._l(e.transformPermissions,function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(t.permissionType))]),e._v(" "),s("td",[s("ol",e._l(t.permissions,function(t,a){return s("li",{key:a},[e._v(e._s(t.permissionName))])}),0)])])}),0)])]),e._v(" "),s("p",[e._v("创建时间: "+e._s(e.userDetail.createDate))]),e._v(" "),s("p",[e._v("更新时间: "+e._s(e.userDetail.updateDate))])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.userUpdateModalDialogShow,expression:"userUpdateModalDialogShow"}],attrs:{title:"用户修改","close-click":e.updateUserModalCloseClick,"sure-click":e.updateUserModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("账号")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.username,expression:"userUpdateInfo.username"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user name (长度6~16)"},domProps:{value:e.userUpdateInfo.username},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"username",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.password,expression:"userUpdateInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"user password (长度8~24)"},domProps:{value:e.userUpdateInfo.password},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"password",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("中文名")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.firstName,expression:"userUpdateInfo.firstName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"chinese name (长度2~16)",minlength:"1",maxlength:"16"},domProps:{value:e.userUpdateInfo.firstName},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"firstName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("英文名")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.lastName,expression:"userUpdateInfo.lastName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"english name (长度2~32)"},domProps:{value:e.userUpdateInfo.lastName},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"lastName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("公司")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.company,expression:"userUpdateInfo.company"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user company (长度2~32)",maxlength:"32"},domProps:{value:e.userUpdateInfo.company},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"company",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.department,expression:"userUpdateInfo.department"}],staticClass:"form-control",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.userUpdateInfo,"department",t.target.multiple?s:s[0])}}},e._l(e.departments,function(t,a){return s("option",{key:a},[e._v(e._s(t.departmentName))])}),0)]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必选")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("职位")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.duty,expression:"userUpdateInfo.duty"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user company (长度2~16)",maxlength:"16"},domProps:{value:e.userUpdateInfo.duty},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"duty",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("邮箱")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.email,expression:"userUpdateInfo.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"user email"},domProps:{value:e.userUpdateInfo.email},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"email",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("电话")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.phone,expression:"userUpdateInfo.phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"user phone"},domProps:{value:e.userUpdateInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.userUpdateInfo,"phone",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{staticClass:"file-upload",attrs:{type:"file"},on:{change:e.selectUpdateLogo}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("状态")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userUpdateInfo.statusValue,expression:"userUpdateInfo.statusValue"}],staticClass:"form-control",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.userUpdateInfo,"statusValue",t.target.multiple?s:s[0])}}},[s("option",[e._v("禁用")]),e._v(" "),s("option",[e._v("开放")])])])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色")]),e._v(" "),s("div",{staticClass:"col-sm-9"},e._l(e.tenantRoleInfos,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkUserRoleIds,expression:"checkUserRoleIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkUserRoleIds)?e._i(e.checkUserRoleIds,t.id)>-1:e.checkUserRoleIds},on:{change:function(s){var a=e.checkUserRoleIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkUserRoleIds=a.concat([i])):l>-1&&(e.checkUserRoleIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkUserRoleIds=n}}}),e._v("\n                "+e._s(t.roleName)+"\n              ")])}),0)])])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{href:"javascript:"}},[this._v("用户名")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{href:"javascript:"}},[this._v("中文名")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{href:"javascript:"}},[this._v("英文名")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{href:"javascript:"}},[this._v("部门")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"text-center"},[e._v("公司")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("部门")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("账号")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("中文名")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("状态")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("操作")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("a",{attrs:{href:"#","aria-label":"Previous"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("«")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("a",{attrs:{href:"#","aria-label":"Next"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("»")])])}]};var $=s("VU/8")(N,M,!1,function(e){s("7z0o")},"data-v-3ec434f3",null).exports,T={name:"TortoiseDepartment",components:{ModalDialog:D},data:function(){return{departments:[],departmentOperate:!1,departmentAddModalDialogShow:!1,departmentUpdateModalDialogShow:!1,departmentDeleteModalDialogShow:!1,departmentAuthorizationModalDialogShow:!1,departmentInfo:{departmentName:"",departmentDesc:""},currentDepartmentInfoIndex:0,currentDepartmentInfo:{},tenantRoleInfos:[],checkUserRoleIds:[]}},beforeDestroy:function(){!0===this.departmentOperate&&(this.$global.getAuthInfo().object.departmentInfos=this.departments,sessionStorage.setItem(this.$global.cacheKey.authInfoKey,f()(this.$global.getAuthInfo())),this.departmentOperate=!1)},mounted:function(){var e=this;this.departments=null!=this.$global.getAuthInfo().object.departmentInfos?this.$global.getAuthInfo().object.departmentInfos:[],0===this.tenantRoleInfos.length&&(null==this.$global.getRoleInfos()?this.$axios.get(this.$global.url.role.get).then(function(t){null!==t&&(e.tenantRoleInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(t.data.data)))}):this.tenantRoleInfos=this.$global.getRoleInfos())},methods:{addDepartmentClick:function(){this.departmentInfo={departmentName:"",departmentDesc:""},this.departmentAddModalDialogShow=!0},addDepartmentModalCloseClick:function(){this.departmentAddModalDialogShow=!1},addDepartmentModalSureClick:function(){var e=this;if(this.departmentAddModalDialogShow=!1,this.departmentInfo.departmentName.length>0){var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.$axios.post(this.$global.url.department.add,this.departmentInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s,e.departments.push(a),e.departmentOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"添加部门信息成功"})}})}else this.$pubSub.publish("toastShow",{type:"warning",msg:"部门名称不能为空"})},updateDepartmentModalCloseClick:function(){this.departmentUpdateModalDialogShow=!1},updateDepartmentModalSureClick:function(){var e=this;this.departmentUpdateModalDialogShow=!1;var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.$axios.put(this.$global.url.department.update,this.currentDepartmentInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,e.departments.splice(e.currentDepartmentInfoIndex,1,a),e.departmentOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"修改部门信息成功"})}})},deleteDepartmentModalCloseClick:function(){this.departmentDeleteModalDialogShow=!1},deleteDepartmentModalSureClick:function(){var e=this;this.departmentDeleteModalDialogShow=!1,this.$axios.delete(this.$global.url.department.delete,{params:{id:this.currentDepartmentInfo.id}}).then(function(t){null!==t&&(e.departments.splice(e.currentDepartmentInfoIndex,1),e.departmentOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"部门删除成功"}))})},authorizationDepartmentModalCloseClick:function(){this.departmentAuthorizationModalDialogShow=!1},authorizationDepartmentModalSureClick:function(){this.departmentAuthorizationModalDialogShow=!1},delegateAppItemClick:function(e,t,s){switch(this.currentDepartmentInfoIndex=s,this.currentDepartmentInfo=t,e.target.innerText){case"删除":this.departmentDeleteModalDialogShow=!0;break;case"编辑":this.departmentUpdateModalDialogShow=!0;break;case"授权":this.checkUserRoleIds=[],this.departmentAuthorizationModalDialogShow=!0}}}},R={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topNav"},[s("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:e.addDepartmentClick}},[e._v("新增部门")]),e._v(" "),s("table",{staticClass:"table table-striped table-bordered table-hover text-center top15"},[e._m(0),e._v(" "),s("tbody",e._l(e.departments,function(t,a){return s("tr",{key:a,on:{click:function(s){return e.delegateAppItemClick(s,t,a)}}},[s("td",[e._v(e._s(t.departmentName))]),e._v(" "),s("td",[e._v(e._s(t.departmentDesc))]),e._v(" "),s("td",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-xs btn-danger",attrs:{type:"button"}},[e._v("删除")]),e._v(" "),s("button",{staticClass:"btn btn-xs btn-default",attrs:{type:"button"}},[e._v("编辑")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"btn btn-xs btn-info",attrs:{type:"button"}},[e._v("授权")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"btn btn-xs btn-primary",attrs:{type:"button"}},[e._v("可用")])])])}),0)]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.departmentAddModalDialogShow,expression:"departmentAddModalDialogShow"}],attrs:{title:"部门添加","close-click":e.addDepartmentModalCloseClick,"sure-click":e.addDepartmentModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.departmentInfo.departmentName,expression:"departmentInfo.departmentName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role name (长度1~16)"},domProps:{value:e.departmentInfo.departmentName},on:{input:function(t){t.target.composing||e.$set(e.departmentInfo,"departmentName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.departmentInfo.departmentDesc,expression:"departmentInfo.departmentDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"role description (长度1~128)"},domProps:{value:e.departmentInfo.departmentDesc},on:{input:function(t){t.target.composing||e.$set(e.departmentInfo,"departmentDesc",t.target.value)}}})])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.departmentUpdateModalDialogShow,expression:"departmentUpdateModalDialogShow"}],attrs:{title:"部门修改","close-click":e.updateDepartmentModalCloseClick,"sure-click":e.updateDepartmentModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.currentDepartmentInfo.departmentName,expression:"currentDepartmentInfo.departmentName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role name (长度1~16)"},domProps:{value:e.currentDepartmentInfo.departmentName},on:{input:function(t){t.target.composing||e.$set(e.currentDepartmentInfo,"departmentName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("部门描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.currentDepartmentInfo.departmentDesc,expression:"currentDepartmentInfo.departmentDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"role description (长度1~128)"},domProps:{value:e.currentDepartmentInfo.departmentDesc},on:{input:function(t){t.target.composing||e.$set(e.currentDepartmentInfo,"departmentDesc",t.target.value)}}})])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.departmentDeleteModalDialogShow,expression:"departmentDeleteModalDialogShow"}],attrs:{title:"部门删除","close-click":e.deleteDepartmentModalCloseClick,"sure-click":e.deleteDepartmentModalSureClick}},[s("div",{staticStyle:{"padding-left":"15px"},attrs:{slot:"modalBody"},slot:"modalBody"},[s("p",{staticClass:"top15"},[s("span",{staticClass:"text-danger"},[e._v("提示")]),e._v(":会删除此部门下的所有用户")])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.departmentAuthorizationModalDialogShow,expression:"departmentAuthorizationModalDialogShow"}],attrs:{title:"部门授权","close-click":e.authorizationDepartmentModalCloseClick,"sure-click":e.authorizationDepartmentModalSureClick}},[s("div",{staticStyle:{"padding-left":"15px"},attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("p",{staticClass:"text-info text-center"},[e._v("给部门所有人授于权限")]),e._v(" "),e._l(e.tenantRoleInfos,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkUserRoleIds,expression:"checkUserRoleIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkUserRoleIds)?e._i(e.checkUserRoleIds,t.id)>-1:e.checkUserRoleIds},on:{change:function(s){var a=e.checkUserRoleIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkUserRoleIds=a.concat([i])):l>-1&&(e.checkUserRoleIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkUserRoleIds=n}}}),e._v("\n            "+e._s(t.roleName)+"\n          ")])})],2)])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"text-center"},[this._v("名称")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("描述")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("操作")])])])}]};var F=s("VU/8")(T,R,!1,function(e){s("1pOx")},"data-v-048d30cc",null).exports,E={name:"TortoiseRole",components:{ModalDialog:D},data:function(){return{authInfo:{},roleInfos:[],isAdmin:!1,roleAddModalDialogShow:!1,roleDetailModalDialogShow:!1,roleUpdateModalDialogShow:!1,roleOperate:!1,roleInfo:{roleName:"",roleTag:"",roleDesc:"",roleType:""},validatePass:{roleName:!1,roleType:!1},tenantPermissionInfos:[],transformPermissionMap:new P.a,transformPermissions:[],checkPermissionIds:[],roleDetail:{},roleUpdateInfo:{},currentRoleIndex:0}},mounted:function(){var e=this,t=this.$global.getAuthInfo();if(this.authInfo=t,"1"===t.object.roleIds)this.isAdmin=!0,null==this.$global.getPermissionInfos()?this.$axios.get(this.$global.url.permission.get).then(function(t){null!==t&&(e.cachePermissionInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.permissionInfosKey,f()(t.data.data)),e.transformPermissionInfos(t.data.data))}):(this.cachePermissionInfos=this.$global.getPermissionInfos(),this.transformPermissionInfos(this.cachePermissionInfos));else{var s=[];this.$global.getAuthInfo().object.roleInfos.forEach(function(e){null!==e.permissionInfos&&e.permissionInfos.forEach(function(e){return s.push(e)})}),this.transformPermissionInfos(s)}null==this.$global.getRoleInfos()?"1"===t.object.roleIds?this.$axios.get(this.$global.url.role.get).then(function(t){null!==t&&(e.roleInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(t.data.data)))}):this.$axios.get(this.$global.url.role.get).then(function(t){if(null!==t){var s=t.data.data;null!=s&&s.length>0?(e.roleInfos=s,sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(e.roleInfos))):sessionStorage.setItem(e.$global.cacheKey.roleInfosKey,f()(e.roleInfos))}}):this.roleInfos=this.$global.getRoleInfos()},beforeDestroy:function(){!0===this.roleOperate&&(sessionStorage.setItem(this.$global.cacheKey.roleInfosKey,f()(this.roleInfos)),this.roleOperate=!1)},methods:{transformPermissionInfos:function(e){var t=this;this.transformPermissionMap.clear(),e.forEach(function(e){var s=t.transformPermissionMap.get(e.permissionType);null!=s?s.push(e):(s=[]).push(e),t.transformPermissionMap.set(e.permissionType,s)}),this.transformPermissionMap.forEach(function(e,s){var a={};a.permissionType=s,a.permissions=e,t.transformPermissions.push(a)})},addRoleClick:function(){this.roleAddModalDialogShow=!0},addRoleModalCloseClick:function(){this.roleAddModalDialogShow=!1},addRoleModalSureClick:function(){var e=this;if(this.validatePass.roleName&&this.validatePass.roleType){this.roleAddModalDialogShow=!1;var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),a="";this.checkPermissionIds.forEach(function(e){return a+=e+","}),this.roleInfo.permissionIds=a,this.$axios.post(this.$global.url.role.add,this.roleInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s,e.roleInfos.push(a),e.roleOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"添加角色信息成功"})}})}else this.$pubSub.publish("toastShow",{type:"warning",msg:"请按要求填写必要信息,谢谢!!"})},roleDetailModalCloseClick:function(){this.roleDetailModalDialogShow=!1},roleDetailModalSureClick:function(){this.roleDetailModalDialogShow=!1},updateRoleModalCloseClick:function(){this.roleUpdateModalDialogShow=!1},updateRoleModalSureClick:function(){var e=this,t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),a="";this.checkPermissionIds.forEach(function(e){return a+=e+","}),this.roleUpdateInfo.permissionIds=a,this.roleUpdateModalDialogShow=!1,this.$axios.put(this.$global.url.role.update,this.roleUpdateInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,e.roleInfos.splice(e.currentRoleIndex,1,a),e.roleOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"修改角色信息成功"})}})},delegateAppItemClick:function(e,t,s){var a=this;switch(e.target.innerText){case"删除":this.$axios.delete(this.$global.url.role.delete,{params:{id:t.id}}).then(function(e){null!==e&&(a.roleInfos.splice(s,1),a.roleOperate=!0,a.$pubSub.publish("toastShow",{type:"success",msg:"角色删除成功"}))});break;case"详情":var o="";null!=t.permissionInfos&&t.permissionInfos.length>0&&t.permissionInfos.forEach(function(e){o+=e.permissionName+" "}),t.permissionNames=o,this.roleDetail=t,this.roleDetailModalDialogShow=!0;break;case"修改":if(this.checkPermissionIds=[],null!=t.permissionIds&&t.permissionIds.length>0)t.permissionIds.split(",").forEach(function(e){return a.checkPermissionIds.push(e)});this.roleUpdateInfo=t,this.roleUpdateModalDialogShow=!0,this.currentRoleIndex=s}}},watch:{"roleInfo.roleName":{deep:!0,handler:function(e,t){this.validatePass.roleName=e.length>0&&e.length<15}},"roleInfo.roleType":{deep:!0,handler:function(e,t){this.validatePass.roleType=e.length>0&&e.length<32}}}},B={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topNav"},[s("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:e.addRoleClick}},[e._v("新增角色")]),e._v(" "),s("div",{staticClass:"row"},e._l(e.roleInfos,function(t,a){return s("div",{key:a,staticClass:"col-sm-3 top15",on:{click:function(s){return e.delegateAppItemClick(s,t,a)}}},[s("div",{staticClass:"panel panel-default"},[s("div",{staticClass:"panel-heading"},[s("h3",{staticClass:"panel-title"},[e._v(e._s(t.roleName))])]),e._v(" "),s("div",{staticClass:"panel-body"},[s("ul",{staticClass:"list-unstyled"},e._l(t.permissionInfos,function(t,a){return s("li",{key:a,staticClass:"li_style_bottom li_style_height"},[e._v("\n                "+e._s(t.permissionName)+"\n              ")])}),0)]),e._v(" "),s("div",{staticClass:"panel-footer text-center"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.id>2,expression:"item.id>2"}],staticClass:"btn btn-xs btn-danger",attrs:{type:"button"}},[e._v("删除")]),e._v(" "),s("button",{staticClass:"btn btn-xs btn-info",attrs:{type:"button"}},[e._v("详情")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.id>2,expression:"item.id>2"}],staticClass:"btn btn-xs btn-default",attrs:{type:"button"}},[e._v("修改")])])])])}),0),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.roleAddModalDialogShow,expression:"roleAddModalDialogShow"}],attrs:{title:"角色添加","close-click":e.addRoleModalCloseClick,"sure-click":e.addRoleModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.roleName,expression:"roleInfo.roleName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role name (长度1~16)"},domProps:{value:e.roleInfo.roleName},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"roleName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色标记")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.roleTag,expression:"roleInfo.roleTag"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role tag (长度1~32)"},domProps:{value:e.roleInfo.roleTag},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"roleTag",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.roleDesc,expression:"roleInfo.roleDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"role description (长度1~128)"},domProps:{value:e.roleInfo.roleDesc},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"roleDesc",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色类型")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.roleType,expression:"roleInfo.roleType"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role type (长度2~32)",disabled:!e.validatePass.roleName},domProps:{value:e.roleInfo.roleType},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"roleType",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("table",{staticClass:"table table-striped table-bordered table-hover text-center"},[s("thead",[s("tr",[s("th",{staticClass:"text-center"},[e._v("类型")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("操作")])])]),e._v(" "),s("tbody",e._l(e.transformPermissions,function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(t.permissionType))]),e._v(" "),s("td",e._l(t.permissions,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkPermissionIds,expression:"checkPermissionIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkPermissionIds)?e._i(e.checkPermissionIds,t.id)>-1:e.checkPermissionIds},on:{change:function(s){var a=e.checkPermissionIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkPermissionIds=a.concat([i])):l>-1&&(e.checkPermissionIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkPermissionIds=n}}}),e._v(" "+e._s(t.permissionName)+"\n                    ")])}),0)])}),0)])]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必选")])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.roleDetailModalDialogShow,expression:"roleDetailModalDialogShow"}],attrs:{title:"角色详情","close-click":e.roleDetailModalCloseClick,"sure-click":e.roleDetailModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-1"}),e._v(" "),s("div",{staticClass:"col-sm-11"},[s("h3",{staticClass:"h3"},[e._v(e._s(e.roleDetail.roleName))]),e._v(" "),s("p",[e._v("标记: "+e._s(e.roleDetail.roleTag))]),e._v(" "),s("p",[e._v("类型: "+e._s(e.roleDetail.roleType))]),e._v(" "),s("p",[e._v("描述: "+e._s(e.roleDetail.roleDesc))]),e._v(" "),s("p",[e._v("权限: "+e._s(e.roleDetail.permissionNames))]),e._v(" "),s("p",[e._v("创建时间: "+e._s(e.roleDetail.createDate))]),e._v(" "),s("p",[e._v("更新时间: "+e._s(e.roleDetail.updateDate))])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.roleUpdateModalDialogShow,expression:"roleUpdateModalDialogShow"}],attrs:{title:"角色修改","close-click":e.updateRoleModalCloseClick,"sure-click":e.updateRoleModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleUpdateInfo.roleName,expression:"roleUpdateInfo.roleName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role name (长度1~16)"},domProps:{value:e.roleUpdateInfo.roleName},on:{input:function(t){t.target.composing||e.$set(e.roleUpdateInfo,"roleName",t.target.value)}}})])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色标记")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleUpdateInfo.roleTag,expression:"roleUpdateInfo.roleTag"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role tag (长度1~32)",disabled:""},domProps:{value:e.roleUpdateInfo.roleTag},on:{input:function(t){t.target.composing||e.$set(e.roleUpdateInfo,"roleTag",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.roleUpdateInfo.roleDesc,expression:"roleUpdateInfo.roleDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"role description (长度1~128)"},domProps:{value:e.roleUpdateInfo.roleDesc},on:{input:function(t){t.target.composing||e.$set(e.roleUpdateInfo,"roleDesc",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("角色类型")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.roleUpdateInfo.roleType,expression:"roleUpdateInfo.roleType"}],staticClass:"form-control",attrs:{type:"text",placeholder:"role type (长度2~32)"},domProps:{value:e.roleUpdateInfo.roleType},on:{input:function(t){t.target.composing||e.$set(e.roleUpdateInfo,"roleType",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("table",{staticClass:"table table-striped table-bordered table-hover text-center"},[s("thead",[s("tr",[s("th",{staticClass:"text-center"},[e._v("类型")]),e._v(" "),s("th",{staticClass:"text-center"},[e._v("操作")])])]),e._v(" "),s("tbody",e._l(e.transformPermissions,function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(t.permissionType))]),e._v(" "),s("td",e._l(t.permissions,function(t,a){return s("label",{key:a,staticClass:"checkbox-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkPermissionIds,expression:"checkPermissionIds"}],attrs:{type:"checkbox",disabled:t.id<3},domProps:{value:t.id,checked:Array.isArray(e.checkPermissionIds)?e._i(e.checkPermissionIds,t.id)>-1:e.checkPermissionIds},on:{change:function(s){var a=e.checkPermissionIds,o=s.target,n=!!o.checked;if(Array.isArray(a)){var i=t.id,l=e._i(a,i);o.checked?l<0&&(e.checkPermissionIds=a.concat([i])):l>-1&&(e.checkPermissionIds=a.slice(0,l).concat(a.slice(l+1)))}else e.checkPermissionIds=n}}}),e._v(" "+e._s(t.permissionName)+"\n                    ")])}),0)])}),0)])])])])])])],1)},staticRenderFns:[]};var L=s("VU/8")(E,B,!1,function(e){s("rPUl")},"data-v-088dbd0b",null).exports,K={name:"TortoisePermission",components:{ModalDialog:D},data:function(){return{permissionInfos:[],transformPermissionMap:new P.a,cachePermissionInfos:[],isAdmin:!1,permissionAddModalDialogShow:!1,permissionDetailModalDialogShow:!1,permissionUpdateModalDialogShow:!1,permissionOperate:!1,permissionInfo:{permissionName:"",permissionTag:"",permissionDesc:"",permissionType:""},validatePass:{permissionName:!1,permissionTag:!1,permissionType:!1},permissionDetail:{},permissionUpdateInfo:{},currentPermissionIndex:0}},mounted:function(){var e=this;if("1"===this.$global.getAuthInfo().object.roleIds)this.isAdmin=!0,null==this.$global.getPermissionInfos()?this.$axios.get(this.$global.url.permission.get).then(function(t){null!==t&&(e.cachePermissionInfos=t.data.data,sessionStorage.setItem(e.$global.cacheKey.permissionInfosKey,f()(t.data.data)),e.transformPermissionInfos(t.data.data))}):(this.cachePermissionInfos=this.$global.getPermissionInfos(),this.transformPermissionInfos(this.cachePermissionInfos));else{var t=[];this.$global.getAuthInfo().object.roleInfos.forEach(function(e){null!==e.permissionInfos&&e.permissionInfos.forEach(function(e){return t.push(e)})}),this.transformPermissionInfos(t)}},methods:{transformPermissionInfos:function(e){var t=this;this.transformPermissionMap.clear(),e.forEach(function(e){var s=t.transformPermissionMap.get(e.permissionType);null!=s?s.push(e):(s=[]).push(e),t.transformPermissionMap.set(e.permissionType,s)}),this.transformPermissionMap.forEach(function(e,s){var a={};a.permissionType=s,a.permissions=e,t.permissionInfos.push(a)})},addPermissionClick:function(){this.permissionInfo={permissionName:"",permissionTag:"",permissionDesc:"",permissionType:""},this.permissionAddModalDialogShow=!0},addPermissionModalCloseClick:function(){this.permissionAddModalDialogShow=!1},addPermissionModalSureClick:function(){var e=this;if(this.validatePass.permissionTag&&this.validatePass.permissionName&&this.validatePass.permissionType){this.permissionAddModalDialogShow=!1;var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.$axios.post(this.$global.url.permission.add,this.permissionInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s;var o=e.transformPermissionMap.get(a.permissionType);null!=o?o.push(a):(o=[]).push(a),e.transformPermissionMap.set(a.permissionType,o),e.permissionInfos=[],e.transformPermissionMap.forEach(function(t,s){var a={};a.permissionType=s,a.permissions=t,e.permissionInfos.push(a)}),e.cachePermissionInfos.push(a),e.permissionOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"添加权限信息成功"})}})}else this.$pubSub.publish("toastShow",{type:"warning",msg:"请按要求填写必要信息,谢谢!!"})},permissionDetailModalCloseClick:function(){this.permissionDetailModalDialogShow=!1},permissionDetailModalSureClick:function(){this.permissionDetailModalDialogShow=!1},updatePermissionModalCloseClick:function(){this.permissionUpdateModalDialogShow=!1},updatePermissionModalSureClick:function(){var e=this;this.permissionUpdateModalDialogShow=!1;var t=new Date,s=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.$axios.put(this.$global.url.permission.update,this.permissionUpdateInfo).then(function(t){if(null!==t){var a=t.data.data;a.updateDate=s,a.createDate=s,e.permissionInfos.splice(e.currentPermissionIndex,1,a),e.permissionOperate=!0,e.$pubSub.publish("toastShow",{type:"success",msg:"修改权限信息成功"})}})},delegateAppItemClick:function(e,t,s){var a=this;switch(e.target.innerText){case"删除":this.$axios.delete(this.$global.url.permission.delete,{params:{id:t.id}}).then(function(e){if(null!==e){var o=a.transformPermissionMap.get(t.permissionType);null!=o&&(o.splice(s,1),1===o.length&&a.transformPermissionMap.delete(t.permissionType)),a.transformPermissionMap.set(t.permissionType,o),a.permissionInfos=[],a.transformPermissionMap.forEach(function(e,t){var s={};s.permissionType=t,s.permissions=e,a.permissionInfos.push(s)});for(var n=0;n<a.cachePermissionInfos.length;n++){var i=a.cachePermissionInfos[n];if(i.permissionType===t.permissionType&&i.permissionName===t.permissionName){a.cachePermissionInfos.splice(n,1);break}}a.permissionOperate=!0,a.$pubSub.publish("toastShow",{type:"success",msg:"权限删除成功"})}});break;case"详情":this.permissionDetail=t,this.permissionDetailModalDialogShow=!0;break;case"修改":this.permissionUpdateInfo=t,this.currentPermissionIndex=s,this.permissionUpdateModalDialogShow=!0}},delegateItemAddClick:function(e,t,s){this.permissionInfo.permissionType=t.permissionType,this.permissionAddModalDialogShow=!0}},beforeDestroy:function(){!0===this.permissionOperate&&(sessionStorage.setItem(this.$global.cacheKey.permissionInfosKey,f()(this.cachePermissionInfos)),this.permissionOperate=!1)},watch:{"permissionInfo.permissionName":{deep:!0,handler:function(e,t){this.validatePass.permissionName=e.length>0&&e.length<15}},"permissionInfo.permissionTag":{deep:!0,handler:function(e,t){this.validatePass.permissionTag=e.length>0&&e.length<32}},"permissionInfo.permissionType":{deep:!0,handler:function(e,t){this.validatePass.permissionType=e.length>0&&e.length<32}}}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topNav"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:e.addPermissionClick}},[e._v("新增权限")]),e._v(" "),s("div",{staticClass:"row"},e._l(e.permissionInfos,function(t,a){return s("div",{key:a,staticClass:"col-sm-4 top15"},[s("div",{staticClass:"panel panel-default"},[s("div",{staticClass:"panel-heading"},[s("h3",{staticClass:"panel-title"},[e._v(e._s(t.permissionType)+"\n              "),s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-xs btn-success pull-right",attrs:{type:"button"},on:{click:function(s){return e.delegateItemAddClick(s,t,a)}}},[e._v("添加\n              ")])])]),e._v(" "),s("div",{staticClass:"panel-body"},[s("ul",{staticClass:"list-unstyled"},e._l(t.permissions,function(t,a){return s("li",{key:a,staticClass:"li_style_bottom li_style_height",on:{click:function(s){return e.delegateAppItemClick(s,t,a)}}},[e._v("\n                "+e._s(t.permissionName)+"\n                "),s("div",{staticClass:"pull-right"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin&&t.id>2,expression:"isAdmin && item1.id>2"}],staticClass:"btn btn-xs btn-danger",attrs:{type:"button"}},[e._v("删除")]),e._v(" "),s("button",{staticClass:"btn btn-xs btn-info",attrs:{type:"button"}},[e._v("详情")]),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin&&t.id>2,expression:"isAdmin && item1.id>2"}],staticClass:"btn btn-xs btn-default",attrs:{type:"button"}},[e._v("修改")])])])}),0)])])])}),0),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.permissionAddModalDialogShow,expression:"permissionAddModalDialogShow"}],attrs:{title:"权限添加","close-click":e.addPermissionModalCloseClick,"sure-click":e.addPermissionModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionInfo.permissionName,expression:"permissionInfo.permissionName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission name (长度1~16)"},domProps:{value:e.permissionInfo.permissionName},on:{input:function(t){t.target.composing||e.$set(e.permissionInfo,"permissionName",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限标记")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionInfo.permissionTag,expression:"permissionInfo.permissionTag"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission tag (长度1~32)",disabled:!e.validatePass.permissionName},domProps:{value:e.permissionInfo.permissionTag},on:{input:function(t){t.target.composing||e.$set(e.permissionInfo,"permissionTag",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.permissionInfo.permissionDesc,expression:"permissionInfo.permissionDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"permission description (长度1~128)"},domProps:{value:e.permissionInfo.permissionDesc},on:{input:function(t){t.target.composing||e.$set(e.permissionInfo,"permissionDesc",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限类型")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionInfo.permissionType,expression:"permissionInfo.permissionType"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission type (长度2~32)",disabled:!e.validatePass.permissionTag},domProps:{value:e.permissionInfo.permissionType},on:{input:function(t){t.target.composing||e.$set(e.permissionInfo,"permissionType",t.target.value)}}})]),e._v(" "),s("span",{staticClass:"text-info small"},[e._v("必填")])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.permissionDetailModalDialogShow,expression:"permissionDetailModalDialogShow"}],attrs:{title:"权限详情","close-click":e.permissionDetailModalCloseClick,"sure-click":e.permissionDetailModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-1"}),e._v(" "),s("div",{staticClass:"col-sm-11"},[s("h3",{staticClass:"h3"},[e._v(e._s(e.permissionDetail.permissionName))]),e._v(" "),s("p",[e._v("标记: "+e._s(e.permissionDetail.permissionTag))]),e._v(" "),s("p",[e._v("类型: "+e._s(e.permissionDetail.permissionType))]),e._v(" "),s("p",[e._v("描述: "+e._s(e.permissionDetail.permissionDesc))]),e._v(" "),s("p",[e._v("创建时间: "+e._s(e.permissionDetail.createDate))]),e._v(" "),s("p",[e._v("更新时间: "+e._s(e.permissionDetail.updateDate))])])])])]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.permissionUpdateModalDialogShow,expression:"permissionUpdateModalDialogShow"}],attrs:{title:"权限修改","close-click":e.updatePermissionModalCloseClick,"sure-click":e.updatePermissionModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionUpdateInfo.permissionName,expression:"permissionUpdateInfo.permissionName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission name (长度1~16)"},domProps:{value:e.permissionUpdateInfo.permissionName},on:{input:function(t){t.target.composing||e.$set(e.permissionUpdateInfo,"permissionName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限标记")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionUpdateInfo.permissionTag,expression:"permissionUpdateInfo.permissionTag"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission tag (长度1~32)",disabled:""},domProps:{value:e.permissionUpdateInfo.permissionTag},on:{input:function(t){t.target.composing||e.$set(e.permissionUpdateInfo,"permissionTag",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限描述")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.permissionUpdateInfo.permissionDesc,expression:"permissionUpdateInfo.permissionDesc"}],staticClass:"form-control",attrs:{rows:"3",type:"text",placeholder:"permission description (长度1~128)"},domProps:{value:e.permissionUpdateInfo.permissionDesc},on:{input:function(t){t.target.composing||e.$set(e.permissionUpdateInfo,"permissionDesc",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("权限类型")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissionUpdateInfo.permissionType,expression:"permissionUpdateInfo.permissionType"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permission type (长度2~32)",disabled:""},domProps:{value:e.permissionUpdateInfo.permissionType},on:{input:function(t){t.target.composing||e.$set(e.permissionUpdateInfo,"permissionType",t.target.value)}}})])])])])])],1)},staticRenderFns:[]};var V=s("VU/8")(K,O,!1,function(e){s("W7mo")},"data-v-e1d99c94",null).exports,j={name:"TortoisePersonal",components:{ModalDialog:D},data:function(){return{personalInfo:null,personalUpdateInfo:{tenantName:"",password:"",surePassword:"",email:null,phone:null,headFile:null},personalUpdateModalDialogShow:!1,validatePass:{surePassword:!1,headFile:!1}}},created:function(){this.personalInfo=this.$global.getAuthInfo()},methods:{updatePersonalInfoClick:function(){this.personalUpdateModalDialogShow=!0},personalUpdateModalCloseClick:function(){this.personalUpdateModalDialogShow=!1},personalUpdateModalSureClick:function(){var e=this;this.personalUpdateModalDialogShow=!1;var t=new FormData;this.personalUpdateInfo.tenantName.length>0&&(this.personalUpdateInfo.tenantName.length>5?t.append("tenantName",this.personalUpdateInfo.tenantName):this.$pubSub.publish("toastShow",{type:"warning",msg:"租户名称大于5位"})),this.personalUpdateInfo.password.length>0&&(this.personalUpdateInfo.password.length>7&&this.validatePass.surePassword?t.append("password",this.personalUpdateInfo.password):this.$pubSub.publish("toastShow",{type:"warning",msg:"密码长度大于7位或两次输入密码不一致"})),this.personalUpdateInfo.email&&t.append("email",this.personalUpdateInfo.email),this.personalUpdateInfo.phone&&t.append("phone",this.personalUpdateInfo.phone),this.validatePass.headFile&&t.append("headFile",this.personalUpdateInfo.headFile),this.$axios.put(this.$global.url.tenant.updatePersonal,t).then(function(t){if(null!==t){var s=t.data.data;null!=s.tenantName&&(e.personalInfo.object.tenantName=s.tenantName),null!=s.email&&(e.personalInfo.object.email=s.email),null!=s.phone&&(e.personalInfo.object.phone=s.phone),null!=s.headUrl&&(e.personalInfo.object.headUrl=s.headUrl),sessionStorage.setItem(e.$global.cacheKey.authInfoKey,f()(e.personalInfo)),e.$pubSub.publish("toastShow",{type:"success",msg:"修改个人信息成功"})}})},selectUpdateLogo:function(e){this.personalUpdateInfo.headFile=e.target.files[0],this.validatePass.headFile=/\.(png|jpg|gif)$/i.test(this.personalUpdateInfo.headFile.name)&&this.personalUpdateInfo.headFile.size<2097152}},watch:{"personalUpdateInfo.surePassword":{deep:!0,handler:function(e,t){this.validatePass.surePassword=e===this.personalUpdateInfo.password}},"personalUpdateInfo.password":{deep:!0,handler:function(e,t){this.validatePass.surePassword=e===this.personalUpdateInfo.surePassword}}}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"top15"},[s("div",[s("span",{staticClass:"h3"},[e._v(e._s(e.personalInfo.object.tenantName))]),e._v(" "),s("button",{staticClass:"btn btn-default pull-right",attrs:{type:"button"},on:{click:e.updatePersonalInfoClick}},[e._v("修改个人信息")])]),e._v(" "),s("p",{staticClass:"top15"},[e._v("状态: "),s("span",{staticClass:"text-info"},[e._v(e._s(1===e.personalInfo.object.status?"开放":"禁用"))])]),e._v(" "),s("p",[e._v("公司: "+e._s(e.personalInfo.object.company))]),e._v(" "),s("p",[e._v("号码: "+e._s(e.personalInfo.object.phone))]),e._v(" "),s("p",[e._v("邮箱: "+e._s(e.personalInfo.object.email))]),e._v(" "),s("p",[e._v("角色: "+e._s(e.personalInfo.object.roleNames))]),e._v(" "),s("p",[e._v("权限: "+e._s(e.personalInfo.object.permissionNames))]),e._v(" "),s("p",[e._v("创建时间: "+e._s(e.personalInfo.object.createDate))]),e._v(" "),s("p",[e._v("更新时间: "+e._s(e.personalInfo.object.updateDate))]),e._v(" "),s("table",{staticClass:"table table-striped table-bordered table-hover text-center top15"},[e._m(0),e._v(" "),s("tbody",e._l(e.personalInfo.object.roleInfos,function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(t.roleName))]),e._v(" "),s("td",[e._v(e._s(t.roleDesc))]),e._v(" "),s("td",[e._v(e._s(t.roleType))]),e._v(" "),s("td",[s("table",{staticClass:"table table-striped table-bordered table-hover text-center"},[e._m(1,!0),e._v(" "),s("tbody",e._l(t.permissionInfos,function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(t.permissionName))]),e._v(" "),s("td",[e._v(e._s(t.permissionDesc))]),e._v(" "),s("td",[e._v(e._s(t.permissionType))])])}),0)])])])}),0)]),e._v(" "),s("ModalDialog",{directives:[{name:"show",rawName:"v-show",value:e.personalUpdateModalDialogShow,expression:"personalUpdateModalDialogShow"}],attrs:{title:"个人信息修改","close-click":e.personalUpdateModalCloseClick,"sure-click":e.personalUpdateModalSureClick}},[s("div",{attrs:{slot:"modalBody"},slot:"modalBody"},[s("div",{staticClass:"form-group top15"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("名称")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.personalUpdateInfo.tenantName,expression:"personalUpdateInfo.tenantName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant name (长度6~16)"},domProps:{value:e.personalUpdateInfo.tenantName},on:{input:function(t){t.target.composing||e.$set(e.personalUpdateInfo,"tenantName",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.personalUpdateInfo.password,expression:"personalUpdateInfo.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"tenant password (长度8~24)"},domProps:{value:e.personalUpdateInfo.password},on:{input:function(t){t.target.composing||e.$set(e.personalUpdateInfo,"password",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("确认密码")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.personalUpdateInfo.surePassword,expression:"personalUpdateInfo.surePassword"}],staticClass:"form-control",attrs:{type:"password",placeholder:"tenant password (长度8~24)"},domProps:{value:e.personalUpdateInfo.surePassword},on:{input:function(t){t.target.composing||e.$set(e.personalUpdateInfo,"surePassword",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("邮箱")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.personalUpdateInfo.email,expression:"personalUpdateInfo.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"tenant email"},domProps:{value:e.personalUpdateInfo.email},on:{input:function(t){t.target.composing||e.$set(e.personalUpdateInfo,"email",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("电话")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.personalUpdateInfo.phone,expression:"personalUpdateInfo.phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"tenant phone"},domProps:{value:e.personalUpdateInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.personalUpdateInfo,"phone",t.target.value)}}})])])]),e._v(" "),s("div",{staticClass:"form-group"},[s("div",{staticClass:"row"},[s("label",{staticClass:"col-sm-2 text-center"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{staticClass:"file-upload",attrs:{type:"file"},on:{change:e.selectUpdateLogo}})])])])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"text-center"},[this._v("名称")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("描述")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("类型")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("权限")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"text-center"},[this._v("名称")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("描述")]),this._v(" "),t("th",{staticClass:"text-center"},[this._v("类型")])])])}]};var Q=s("VU/8")(j,z,!1,function(e){s("R6dY")},"data-v-55008bca",null).exports;n.a.use(h.a);var H=new h.a({routes:[{path:"/",redirect:"index"},{path:"/index",component:b,children:[{path:"tenant",component:U},{path:"user",component:$},{path:"role",component:L},{path:"permission",component:V},{path:"department",component:F},{path:"personal",component:Q}]},{path:"/login",component:_}]}),Y=s("mtWM"),G=s.n(Y),q=s("x9pK"),Z=s.n(q),J={authInfoKey:"authInfoKey",tenantInfosKey:"tenantInfosKey",roleInfosKey:"roleInfosKey",permissionInfosKey:"permissionInfosKey"},W=null,X=null,ee=null,te=null,se={url:{base:"http://10.124.132.49:8088/tortoise",tenant:{add:"/tenant/add",delete:"/tenant/delete",get:"/tenant/get",update:"/tenant/update",updateTenantStatus:"/tenant/updateTenantStatus",updatePersonal:"/tenant/updatePersonal",auth:"/tenant/auth",authMultipoint:"/tenant/authMultipoint"},user:{add:"/user/add",delete:"/user/delete",get:"/user/get",update:"/user/update",auth:"/user/auth",authMultipoint:"/user/authMultipoint"},role:{add:"/role/add",delete:"/role/delete",get:"/role/get",update:"/role/update"},permission:{add:"/permission/add",delete:"/permission/delete",get:"/permission/get",update:"/permission/update"},department:{add:"/department/add",delete:"/department/delete",get:"/department/get",update:"/department/update"}},cacheKey:J,getAuthInfo:function(){if(null!=W)return W;var e=sessionStorage.getItem(J.authInfoKey);return null!=e&&(W=JSON.parse(e)),W},getTenantInfos:function(){if(null!=X)return X;var e=sessionStorage.getItem(J.tenantInfosKey);return null!=e&&(X=JSON.parse(e)),X},getRoleInfos:function(){if(null!=ee)return ee;var e=sessionStorage.getItem(J.roleInfosKey);return null!=e&&(ee=JSON.parse(e)),ee},getPermissionInfos:function(){if(null!=te)return te;var e=sessionStorage.getItem(J.permissionInfosKey);return null!=e&&(te=JSON.parse(e)),te},destroy:function(){W=null,X=null,ee=null,te=null,sessionStorage.removeItem(J.authInfoKey),sessionStorage.removeItem(J.tenantInfosKey),sessionStorage.removeItem(J.roleInfosKey),sessionStorage.removeItem(J.permissionInfosKey),sessionStorage.clear()}},ae={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};var oe=s("VU/8")(se,ae,!1,function(e){s("xP4P")},"data-v-0ff137d4",null).exports;G.a.defaults.timeout=1e4,G.a.defaults.baseURL=oe.url.base,G.a.defaults.headers.common.token=null,G.a.interceptors.request.use(function(e){return Z.a.publish("progressShow",!0),e},function(e){return o.a.reject(e)}),G.a.interceptors.response.use(function(e){if(Z.a.publish("progressShow",!1),240===e.data.status){if(Z.a.publish("toastShow",{type:"error",msg:e.data.errorInfo}),"token invalid"===e.data.errorInfo||"认证失效"===e.data.errorInfo)var t=setTimeout(function(){H.replace("/login"),clearTimeout(t)},2e3);return null}return e},function(e){return Z.a.publish("progressShow",!1),Z.a.publish("toastShow",{type:"error",msg:"服务器异常,请稍后重试"}),o.a.reject(e.response)}),n.a.prototype.$axios=G.a,n.a.prototype.$pubSub=Z.a,n.a.prototype.$global=oe,n.a.config.productionTip=!1,new n.a({el:"#app",router:H,components:{App:u},template:"<App/>"})},Oujo:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAACJklEQVQ4T6VUQY6bQBDsRiABysG+WGJ8iHPL0T8IP4ifwP5g84LwgWidF8T5gfOCcImUW5wXxIcwSL7AiUEy0KuywGI3a2wpXCw8dHV1ddUwjTxa63siekdEExHZO47zeTab7cZqeHiYZVkoIivP8+KyLL8z829m3nTfLEQkZuY4CIL+v3+wnwCmabqzLGstIksRKebzeTysyPN8YozZMXMYBMH+JaZnwCzLwGCnlJporUUp9aRZX5ym6anJ82b9+RAQ48ZKqfAaIDMvlFLRNYYA/KKUeqO1LjzPW0yn0+J50c0MUai13jNzhMX8t4Yd4Bq/2LIxZisif4hoa1lW0S3qDku7actZloHZ2rbtEF47HA7Luq4/MvNbEXnFzH9F5Kdt21/HvHhayhCsrusFET0QEc4SGPq8QWacrYjol+d5kTEGE+2VUh/O33RMEjCr6zokIpj3/tJYeZ6/LsvyBzPnzPypbdtTE2YG8Iq11tAKZkWkNsy8vGTabpqwbdsQPoTReydorRMslMHQcZx9l4AoCIJkLKtIk+M4UdM0yDe8OMH4VVXBGcuThlprvMTz+Xw5BoY0tW279X0/NMZEmApsHcfZNk0DJyQ94AbiX4rTsAluIBGZ+L6/7kAL6A3pmHndA2J+3CKj4wIYEh2Px41lWQ+u636rqgqjvxeROzDvAQtmXt0C2EtERIgqXEG44mzbTuDP3oeh67q7l7J7TVPXdYth3SNCbWOdgylbowAAAABJRU5ErkJggg=="},Qusd:function(e,t){},R6dY:function(e,t){},W7mo:function(e,t){},"i+1B":function(e,t){},lZx4:function(e,t){},rPUl:function(e,t){},w4Qz:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAB2klEQVQ4T61UwXEiMRDsAR6IF3yo0vDhIjDOwJcBF8HhCI6L4HAE5iIwjuCcge0IvI7g+CBV8YEX8ADN1WxJW2t7l/Lj9NgqrUY90z09IvynRXU43vsrEbkAMIwxSyLKrLXPVXc+AHnvhyJyB+ASQCYiT3qRiK4AjAC8ENG1tXZZBnwD5L2fhBBuiejeGDPr9XrbcvBms+nu9/sZgAkRTa21i3ReAGklIYQ8GzM/nJPOOTcGsCCiUaqsAHLOKYWMmaea+XA4/ABwnwI1EYDv7Xb7t1bqnJsDuGDmrzl1/URhH4wxQw1ar9ej4/H4AuAnM+sFOOemAG5brdZlv9/PIk1twNha+5QDxaAxM6ug+dLAKo3K/5QFES1UqwQ0F5HtYDBQIT+9VqvVjIi6KkclkHNOzqExc36vCkj5F9Scc1tm7r4HS7qksw/UVOwQwp9Op/MldmQqIt33VGMFmmSuoLvd7m+j0fhWiB0FL9of99qtERE96l5EtBGvqkf5PDXojSFFJFPXJkOqDU6nk44Fms1mpm2PIPWGjH6aiIhWcmeMuakZkV8ArmtHJAkbh3ahk6/TTkT50Co1EVGqr0Q0OTu05S5Ftyut/BlRUABLFbbKGrXv0addGQP/ASjtGiKEuIuoAAAAAElFTkSuQmCC"},xP4P:function(e,t){},xggO:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAB/klEQVQ4T4VUwW3bQBCcpT46fiJ+BPD4iFNB5AriVBB3EKUDqQN1YKcCswNTFUSpIE4F8UdHQB/5RX4EbjDEnXCmaegAfU7L2ZnZ2ROMnLqurwB8V9UbVZ2JyIsvq0Rkm+f58/AziS+Ox+OsaZo7EVkC2ALYicgTa1R1AeAGwDdVLdM0XWdZFhrgDHQ4HBan0+kRwF8RWY11JSDZEkhVP6Rp+jWA9UBk0rbtHwC/rbVkc/E45wj2OYD1QLwEMLPW3l5EiAqcczsAT9balXhJ9GIRy/EsHwAE8Htr7Tpu5GX+E5FP4py792xeSeI9p5amKQ1G0zTsXhVFsYnBPKuKQCxgt2pYICKbPM/5P01equrSWtsDh7Pf7zdUQ6Bnjjt8EAqccwTeWWvJOPiI4TCcc5S+ehcoeAfgF6UDuB766BucgWh0mec5J/fq0Myu65ZMtjGmjAM4kHb1rtl1XdOLL/GKTCaT7Xw+75MeWdAPQfwImQXS703tuo5rwoxVqtrvlYhw/yjjCGDN4fiIHI0xWR9Igk2n05e2bZkbesFpvZEaTY/ReCyK4ge9JMvzrvkYfDTGXI95EcvxTMi0ZKp7xqEgnpKIrC8s7YOqZkmS3Ia6N89I27bMDd+iMkkSGhneHm49PeLvpzFmM/qMxNQ9O67MglPzZvPt4cNWjbH9D5w4RLCypi39AAAAAElFTkSuQmCC"}},["NHnr"]);
//# sourceMappingURL=app.2a517ff0f7f886e56c21.js.map